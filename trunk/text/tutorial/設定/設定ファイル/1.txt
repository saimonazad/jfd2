設定ファイルのカスタマイズ

この章では、jFD2の設定ファイルの編集方法について解説します。
jFD2は、以下のファイルを設定ファイルとして使用します。

command.xml・・・ファイラー部分のコマンド（コピー、移動、カーソル移動など）の設定
keys.xml・・・ファイラー部分のキーの設定
owner_command.xml・・・ウインドウのコマンドの設定
owner_keys.xml・・・ウインドウのキーの設定
menubar.xml・・・メニューバーの構成の設定
popup.xml・・・右クリック時に表示されるポップアップメニューの設定
function.ini・・・画面下部のファンクションキーパネルの設定
aliase.xml・・・ドライブなどのエイリアスの設定
external_command.xml・・・外部コマンドの設定

以下の二つは設定画面やファイラー画面から直接設定可能なため、
直接編集する必要はありません。
common_config.xml・・・共通の設定
local_config.xml・・・タブ、2画面モードなどで画面ごとに保持される設定

以下に、それぞれの設定方法を解説します。

※command.xml
jFD2の各種コマンドは、カーソルの移動から始まって、ファイルのコピーや移動、ビューアの表示まで
全て独立した小さなプログラム（クラスと呼びます）として実装されています。
これらプログラムに名前を付けて管理しているのがcommand.xmlクラスです。

通常、このファイルを編集する必要はありません。
新規でクラスを作成した場合のみ、このクラスに書き足して登録する必要があります。

command.xmlファイルはXMLファイルで、ルート要素はcommandsタグ、
その下に各コマンドごとにcommandタグを記述します。
commandタグは以下のように書きます。

<command name="（コマンド名）" class="コマンドクラス" cache=（"キャッシュの有無）">
	<param name="パラメータ名">
		（パラメータ）
	</param>
</command>

例えば、名称でソートするコマンド（デフォルトではCtrl+1で実行）の場合、以下のように定義されます。

<command name="sort_name" class="com.nullfish.app.jfd2.command.embed.ChangeSortKeyCommand">
	<param name="sort_key">
		<text>name</text>
	</param>
	<param name="label">
		<text>name</text>
	</param>
</command>

これは、
名称が「sort_name」
コマンドクラスが「com.nullfish.app.jfd2.command.embed.ChangeSortKeyCommand」
「sort_key」というパラメータが「name」という文字列
「label」というパラメータが「name」という文字列
であることを表します。

ここでパラメータはtextタグで文字列が指定されていますが、text以外にも以下のタグが使用可能です。
int・・・整数
boolean・・・真偽値（trueまたはfalse）
color・・・色。
font・・・フォント
list・・・配列



※keys.xml
jFD2のファイラー画面のキー設定はこのファイルで行います。
command.xmlではコマンドに名称を付けて管理しますが、keys.xmlではキーとコマンドの名称を関連づけることで
キー設定を行います。

キー
↓
コマンド名称
↓
コマンド

というふうに辿ることで、キーが押されたときにどのコマンドを実行するか決定しています。
keys.xmlはXMLファイルで、ルート要素はcommandmapsタグ、コマンドごとにcommandmapタグがあります。
commandmapタグは以下のように書きます。

<commandmap name="（コマンド名）">
	<key name="キー名" shift="（シフトキーの有無）" alt="（Altキーの有無）" ctrl="（コントロールキーの有無）" meta="（Metaキーの有無）" onrelease="（キーが離されたときのイベント指定）"/>
</commandmap>
キー名はJavaのjava.awt.KeyEventというクラスに定義されたキー名称を記述します。
下記リンク先を参考にしてください。
http://java.sun.com/j2se/1.5.0/ja/docs/ja/api/java/awt/event/KeyEvent.html
「VK_○○」というのがキー名称です。

shift, alt, ctrl, metaは「true」または「false」を指定し、「true」の場合がONになります。
指定しなかった場合はfalseになります。

例として、前ページ表示（ページアップ、またはShift+↑）の場合は、以下のように記述されます。

<commandmap name="cursor-prev-page">
	<key name="VK_PAGE_UP"/>
	<key name="VK_UP" shift="true"/>
</commandmap>
※owner_command.xml
※owner_keys.xml
owner_command.xmlファイルでは、ウインドウに定義されたコマンドを指定します。
主に、別のタブやウインドウを最前面に表示したりするのに使われます。
また、owner_keys.xmlではウインドウのキー設定を定義します。
それぞれ書式は、command.xml、keys.xmlと同じですので、そちらを参考にしてください。

※menubar.xml、popup.xml
menubar.xmlとpopup.xmlは、それぞれメニューバーと、右クリック字に表示されるコンテキストメニューの
構成を定義します。
それぞれ、同一の書式で記述するXMLファイルです。

このファイルは、以下のタグで構成されます。

menubar
	ルート要素
		子要素 menu, menuitem, separator
menu
	メニュー。クリックするとサブ要素が開きます。
		子要素 menu, menuitem, separator

		label	表示されるラベルのリソース名
		mnemonic	ショートカットキー
menuitem
	メニューアイテム。クリックするとcommand.xml、owner_command.xmlで定義された
	コマンドが実行されます。
		子要素 key

		label	表示されるラベルのリソース名
		command	押されたときに実行されるコマンド名。command.xml, owner_command.xmlで指定されたコマンドの名称を指定します。
keyタグ
	このコマンドに対応するキー。メニューに表示されます。
	keys.xmlのkeyタグと同じ書式で指定してください。
separator
	セパレーター


※function.ini
function.iniはファイラー画面下部分のファンクションキーに相当するパネルを設定します。
プロパティファイル形式で記述し、例えばF7キーのFindの場合、以下のように定義されます。

f7.0.label=Find
f7.0.command=find

最初のf7がキー番号、次の0はシフトキー切り替えによって切り替えられるセット番号、
次がlabelの場合は表示される文字列、commandの場合はcommand.xmlで定義された、実行されるコマンドの名称になります。


jFD2の設定ファイル